# 参考

- [使用应用私钥生成请求签名](https://docs.open.alipay.com/291/105974/)
- [支付宝加密签名](https://docs.open.alipay.com/291/106118)

简而言之，签名的过程即生成签名方（通常为支付宝客户端）将传送的消息用私钥加密的过程；
验签则是指验签方（通常为开放平台的服务端）使用公钥对消息进行验证的过程。

以 JAVA 语言为例，签名和验签的过程大致为：

生成签名方（通常为商户）首先对参数放入一个字符串数组 signFields，把参数和值放入一个对象或 map 中，
使用 JSONObject 把这个对象转化成 json 对象。
然后构建签名原文，在构建签名原文时，我们需把参数按照字典（比如a,b,c）顺序排序，
具体排序方法直接调用 JAVA 的 Arrays.sort 方法。 然后使用 RSA 的私钥对签名原文进行签名。
验签方（通常为开放平台的服务端）：和生产签名方一样先生成签名原文，
然后使用 RAS 的公钥生成签名方传入的签名，把签名原文对生成签名方传入的签名进行验证，
验证结果为 true 则说明验证成功，否则未通过。

## 如何签名

### 筛选并排序

获取所有请求参数，不包括字节类型参数，如文件、字节流，剔除sign字段，剔除值为空的参数，并按照第一个字符的键值ASCII码递增排序（字母升序排序），如果遇到相同字符则按照第二个字符的键值ASCII码递增排序，以此类推。

### 拼接

将排序后的参数与其对应值，组合成“参数=参数值”的格式，并且把这些参数用&字符连接起来，此时生成的字符串为待签名字符串。
